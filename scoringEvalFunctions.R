#
# @author: Nagiza Samatova
# File: scoringEvalFunctions.R

#------------------------
# RMSE function: y is actual value and p is predicted
# RMSE: The square root of the average 
# square of the difference 
# between model prediction and actual value of the response.

rmse <- function (y,p) {sqrt( mean ((y-p)^2) )}

#---------------------
# R-squared function: y is actual value and p is predicted
# R-squared: 1.0 minus how much 
# unexplained variance your model leaves 
# (relative to null model or 
# the average as the prediction)
# Note: Null model: mean(d$y)

rsq <- function(y,p) {1 - sum((y-p)^2)/sum((y-mean(y))^2)}

#---------------------
# Degrees of freedom function: 
# The number of data samples (rows) minus 
# the number of coefficients fit in linear regression model
# Assumption: model is generated by lm() function

df <- function(data, model) {
  return(dim(data)[1] - dim(summary(model)$coefficients)[1])
}

#---------------------
# Residual standard error function: 
# The sum of the square of residuals divided by the degrees of freedom 
# Assumption: model is generated by lm() function

rse <- function(model, df) {
  return(sqrt(sum(residuals(model)^2)/df))
}


